# Challenge Name: Transposed
## Category: Cryptography
### [Challenge Link](https://cybertalents.com/challenges/cryptography/transposed)

In this challenge, you are provided with two files: `encrypt.py` and `output`. The objective is to decrypt the output generated by the encryption script and recover the hidden flag.

#### `encrypt.py`:

```python
# -*- coding:utf-8 -*-

import random

W = 7
perm = range(W)
random.shuffle(perm)

msg = open("flag.txt").read().strip()
while len(msg) % (2 * W):
    msg += "."

for i in range(100):
    msg = msg[1:] + msg[:1]
    msg = msg[0::2] + msg[1::2]
    msg = msg[1:] + msg[:1]
    res = ""
    for j in range(0, len(msg), W):
        for k in range(W):
            res += msg[j:j + W][perm[k]]
    msg = res

print(msg)
```
### Output: ```L{NTP#AGLCSF.#OAR4A#STOL11__}PYCCTO1N#RS.S```
So we can describe the encryption algorithm as follows: 

**Initialization:**

    A permutation of numbers from 0 to 6 is created.
    The flag is loaded from a file and padded with "." characters to ensure its length is a multiple of 14 and stored in msg variable.

**Iterative Transformation (100 iterations):**

    The msg is repeatedly transformed through a series of steps:
        Shuffling of characters by moving the first character to the end, splitting the message into even and odd positions, and shuffling again.
        Reordering of characters within blocks of size 7 according to the shuffled permutation.

**Output:**

    the transformed message is printed as the final result.

### Decryption Approach : 

My approach is that the decryption script will iterates through all possible permutations of the shuffled tuple, attempting to reverse the encryption process to recover the flag that begins with "FLAG{."

#### `decrypt.py`:
```python
import itertools

a = [0, 1, 2, 3, 4, 5, 6]  # range(7)
W = 7
shuffled = list(itertools.permutations(a))

for s in shuffled:
    msg = 'L{NTP#AGLCSF.#OAR4A#STOL11__}PYCCTO1N#RS.S'
    for i in range(100):
        res = ''
        for j in range(0, len(msg), W):
            for k in range(W):
                res += msg[j:j + W][s.index(k)]
        msg = res
        msg = msg[-1] + msg[:-1]
        msg = ''.join([msg[i // 2] if i % 2 == 0 else msg[len(msg) // 2 + i // 2] for i in range(len(msg))])
        msg = msg[-1] + msg[:-1]

    if 'FLAG{' in msg:
        print("[+] FLAG FOUND! : ", msg)
        break
```

It Works ^-^ . ```[+] FLAG FOUND! :  FLAG{##CL4SS1CAL_CRYPTO_TRANSPOS1T1ON##}..```


